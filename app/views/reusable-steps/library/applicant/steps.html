
{% extends "layout.html" %}

{% block pageTitle %}
  GOV.UK Prototype Kit
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      {% include "includes/status-banner-draft.html" %}
      {% include "includes/licence-header-ppl-application.html" %}
      {% include "includes/list-of-sections.html" %}

      <h1 class="govuk-heading-l">Steps library</h1>
      <p>Create a list of all the steps that will be used in this project’s protocols, for example, ‘blood sampling’ or ‘creation of GA embryos’. </p>

      <p>Steps can be a single or combination of procedures and need to include details of adverse effects and humane endpoints (if relevant).</p>

      {% if data["stepId"] > 1 %}
        {% set stepsReference     = data['id1']['ref'] %}
        {% set stepsDetail        = data['id1']['details'] %}
        {% set stepsExpected      = data['id1']['any'] %}
        {% set stepsLimits        = data['id1']['limits'] %}
        {% set likelyStepsEffects = data['id1']['likely'] %}
        {% set stepsEndpoints     = data['id1']['endpoints'] %}
        {% set stepIdAnchor       = 'id1' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 2 %}
        {% set stepsReference     = data['id2']['ref'] %}
        {% set stepsDetail        = data['id2']['details'] %}
        {% set stepsExpected      = data['id2']['any'] %}
        {% set stepsLimits        = data['id2']['limits'] %}
        {% set likelyStepsEffects = data['id2']['likely'] %}
        {% set stepsEndpoints     = data['id2']['endpoints'] %}
        {% set stepIdAnchor       = 'id2' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 3 %}
        {% set stepsReference     = data['id3']['ref'] %}
        {% set stepsDetail        = data['id3']['details'] %}
        {% set stepsOptional      = data['id3']['optional'] %}
        {% set stepsLimits        = data['id3']['limits'] %}
        {% set likelyStepsEffects = data['id3']['likely'] %}
        {% set stepsEndpoints     = data['id3']['endpoints'] %}
        {% set stepIdAnchor       = 'id3' %}


        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 4 %}
        {% set stepsReference     = data['id4']['ref'] %}
        {% set stepsDetail        = data['id4']['details'] %}
        {% set stepsExpected      = data['id4']['any'] %}
        {% set stepsLimits        = data['id4']['limits'] %}
        {% set likelyStepsEffects = data['id4']['likely'] %}
        {% set stepsEndpoints     = data['id4']['endpoints'] %}
        {% set stepIdAnchor       = 'id4' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 5 %}
        {% set stepsReference     = data['id5']['ref'] %}
        {% set stepsDetail        = data['id5']['details'] %}
        {% set stepsExpected      = data['id5']['any'] %}
        {% set stepsLimits        = data['id5']['limits'] %}
        {% set likelyStepsEffects = data['id5']['likely'] %}
        {% set stepsEndpoints     = data['id5']['endpoints'] %}
        {% set stepIdAnchor       = 'id5' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 6 %}
        {% set stepsReference     = data['id6']['ref'] %}
        {% set stepsDetail        = data['id6']['details'] %}
        {% set stepsExpected      = data['id6']['any'] %}
        {% set stepsLimits        = data['id6']['limits'] %}
        {% set likelyStepsEffects = data['id6']['likely'] %}
        {% set stepsEndpoints     = data['id6']['endpoints'] %}
        {% set stepIdAnchor       = 'id6' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 7 %}
        {% set stepsReference     = data['id7']['ref'] %}
        {% set stepsDetail        = data['id7']['details'] %}
        {% set stepsExpected      = data['id7']['any'] %}
        {% set stepsLimits        = data['id7']['limits'] %}
        {% set likelyStepsEffects = data['id7']['likely'] %}
        {% set stepsEndpoints     = data['id7']['endpoints'] %}
        {% set stepIdAnchor       = 'id7' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 8 %}
        {% set stepsReference     = data['id8']['ref'] %}
        {% set stepsDetail        = data['id8']['details'] %}
        {% set stepsExpected      = data['id8']['any'] %}
        {% set stepsLimits        = data['id8']['limits'] %}
        {% set likelyStepsEffects = data['id8']['likely'] %}
        {% set stepsEndpoints     = data['id8']['endpoints'] %}
        {% set stepIdAnchor       = 'id8' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 9 %}
        {% set stepsReference     = data['id9']['ref'] %}
        {% set stepsDetail        = data['id9']['details'] %}
        {% set stepsExpected      = data['id9']['any'] %}
        {% set stepsLimits        = data['id9']['limits'] %}
        {% set likelyStepsEffects = data['id9']['likely'] %}
        {% set stepsEndpoints     = data['id9']['endpoints'] %}
        {% set stepIdAnchor       = 'id9' %}

        {% include "includes/steps-library.html" %}
      {% endif %}
      {% if data["stepId"] > 10 %}
        {% set stepsReference     = data['id10']['ref'] %}
        {% set stepsDetail        = data['id10']['details'] %}
        {% set stepsExpected      = data['id10']['any'] %}
        {% set stepsLimits        = data['id10']['limits'] %}
        {% set likelyStepsEffects = data['id10']['likely'] %}
        {% set stepsEndpoints     = data['id10']['endpoints'] %}
        {% set stepIdAnchor       = 'id10' %}

        {% include "includes/steps-library.html" %}
      {% endif %}

      <div class="comment-block">
        <div class="writeComment hide">
          <form action="steps#add-steps" method="post">
            <h2 class="govuk-heading-m">Create step</h2>

            <div class="govuk-form-group">
              <label class="govuk-label govuk-label--s" for="id{{data['stepId']}}[details]">
                Describe the procedures that will be carried out during this step.
              </label>
              <div id="id{{data['stepId']}}[details]-hint" class="govuk-hint">Explain where one or more steps are repeated in one experiment, list any alternative techniques within a step (e.g. dosing routes), and include all procedures performed under terminal anaesthesia. When describing the technical aspects of a step, be broad enough to be flexible when the variation does not impact on animal welfare (e.g. use "antibiotic" instead of "penicillin"). Finally, avoid specifying volumes and frequencies when they do not impact on animal welfare.</div>
              <textarea class="govuk-textarea" id="id{{data['stepId']}}[details]" name="id{{data['stepId']}}[details]" rows="5" aria-describedby="id{{data['stepId']}}[details]-hint"></textarea>
            </div>

            <div class="govuk-form-group">
              <label class="govuk-label govuk-label--s" for="id{{data['stepId']}}[ref]">
                Quick reference
              </label>
              <div id="id{{data['stepId']}}[ref]-hint" class="govuk-hint">
                For example, ‘in vivo imaging’ or ‘tumor removal’. Choose something distinct that’s easy to recognise when populating protocols.
              </div>
              <input class="govuk-input  govuk-!-width-two-thirds" type='text' id="id{{data['stepId']}}[ref]" name="id{{data['stepId']}}[ref]" aria-describedby="id{{data['stepId']}}[ref]-hint"></input>
            </div>

            <div class="govuk-form-group">
              <fieldset class="govuk-fieldset" aria-describedby="id{{data['stepId']}}[any]-hint">
                <label class="govuk-label--s" for="">
                  Do you expect this step to have adverse effects for the animals that are more than mild and transient?
                </label>
                <div id="id{{data['stepId']}}[any]-hint" class="govuk-hint">Do not list uncommon or unlikely adverse effects, or effects from procedures that will cause no more than transient discomfort and no lasting harm. For example, an intravenous injection of a small volume of an innocuous substance.</div>

                <div class="govuk-radios govuk-radios--conditional" data-module="govuk-radios">
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="steps-expected-{{stepNumber}}-effects-conditional-3" name="id{{data['stepId']}}[any]" type="radio" value="Yes" data-aria-controls="conditional-steps-expected-{{stepNumber}}-effects-conditional-3">
                    <label class="govuk-label govuk-radios__label" for="steps-expected-{{stepNumber}}-effects-conditional-3">
                      Yes
                    </label>
                  </div>
                  <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-steps-expected-{{stepNumber}}-effects-conditional-3">
                    <div class="govuk-form-group">
                      <label class="govuk-label govuk-label--s" for="id{{data['stepId']}}[likely]">
                        What are the likely adverse effects of this step?
                      </label>
                      <div id="id{{data['stepId']}}[likely]-hint" class="govuk-hint">State the expected adverse effect, including the likely incidence, and the anticipated degree and duration of suffering.</div>
                      <textarea class="govuk-textarea" id="id{{data['stepId']}}[likely]" name="id{{data['stepId']}}[likely]" rows="5" aria-describedby="id{{data['stepId']}}[likely]-hint"></textarea>
                    </div>
                    <div class="govuk-form-group">
                      <label class="govuk-label govuk-label--s" for="id{{data['stepId']}}[limits]">
                        How will you monitor for, control, and limit any of these adverse effects?
                      </label>
                      <div id="id{{data['stepId']}}[limits]-hint" class="govuk-hint">If adverse effects can't be prevented, how will you attempt to ameliorate their initial signs?</div>
                      <textarea class="govuk-textarea" id="id{{data['stepId']}}[limits]" name="id{{data['stepId']}}[limits]" rows="5" aria-describedby="id{{data['stepId']}}[limits]-hint"></textarea>
                    </div>
                    <div class="govuk-form-group">
                      <label class="govuk-label govuk-label--s" for="id{{data['stepId']}}[endpoints]">
                        What are the humane endpoints for this step?
                      </label>
                      <div id="id{{data['stepId']}}[endpoints]-hint" class="govuk-hint">This would be the point at which you would kill the animal to prevent further suffering.</div>
                      <textarea class="govuk-textarea" id="id{{data['stepId']}}[endpoints]" name="id{{data['stepId']}}[endpoints]" rows="5" aria-describedby="id{{data['stepId']}}[endpoints]-hint"></textarea>
                    </div>
                  </div>
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="steps-expected-{{stepNumber}}-effects-conditional-4" name="id{{data['stepId']}}[any]" type="radio" value="No" data-aria-controls="conditional-steps-expected-{{stepNumber}}-effects-conditional-4">
                    <label class="govuk-label govuk-radios__label" for="steps-expected-{{stepNumber}}-effects-conditional-4">
                      No
                    </label>
                  </div>
                </div>
              </fieldset>
            </div>



            {% set stepId = data['stepId']|int %}
            {% set nextStep = stepId + 1 %}

            {% set stepCounter = data['stepId'] %}
            {% set addStep = stepCounter + 1 %}

            <input type="hidden" name="stepId" value="{{nextStep}}">
            <button data-module="govuk-button" class="govuk-button">Save</button>
            <a href="#" class="secondary-link">Cancel</a>
          </form>
        </div>

        <div class="initiateComment" >
          <a onClick='initiateComment(this)' class="govuk-button govuk-button--secondary">Create step</a>
        </div>

        <a href="steps-review" class="govuk-button">Continue</a>
        <span class="secondary-link"><a href="ppl-index">List of sections</a></span>
        <span class="secondary-link"><a href="protocols">View protocols</a></span>
        <!-- <form action="steps" method="post">
          <input type="hidden" name="stepId" value="1">
          <button data-module="govuk-button" >Go!</button>
        </form> -->
      </div>
    </div>
  </div>


{% endblock %}
